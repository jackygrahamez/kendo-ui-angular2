{"version":3,"sources":["webpack:///webpack/bootstrap 77ab829606301c35fc66?1c80*************************","webpack:///external \"rxjs/Observable\"?16be","webpack:///./src/scroller.service.ts","webpack:///external \"rxjs/BehaviorSubject\""],"names":[],"mappings":"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","file":"src/scroller.service.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 77ab829606301c35fc66\n **/","module.exports = require(\"rxjs/Observable\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"rxjs/Observable\"\n ** module id = 53\n ** module chunks = 20 26\n **/","import { Observable } from 'rxjs/Observable';\nimport { Subscription } from 'rxjs/Subscription';\nimport { Observer } from 'rxjs/Observer';\nimport { BehaviorSubject } from 'rxjs/BehaviorSubject';\nimport { RowHeightService } from './row-height.service';\n\n/**\n * @hidden\n */\nexport class ScrollAction { constructor(public offset: number) {} }\n\n/**\n * @hidden\n */\nexport class PageAction { constructor(public skip: number, public take: number) {} }\n\n/**\n * @hidden\n */\nexport type Action = ScrollAction | PageAction;\n\n/**\n * @hidden\n */\nexport class ScrollerService {\n    private firstLoaded: number = 0;\n    private lastLoaded: number;\n    private lastScrollTop: number;\n    private take: number;\n    private total: number;\n    private rowHeightService: RowHeightService;\n    private scrollSubscription: Subscription;\n\n    constructor(private scrollObservable: Observable<any>) { }\n\n    public create(rowHeightService: RowHeightService, skip: number, take: number, total: number): Observable<Action> {\n\n        this.rowHeightService = rowHeightService;\n        this.firstLoaded = skip;\n        this.lastLoaded = skip + take;\n        this.take = take;\n        this.total = total;\n        this.lastScrollTop = 0;\n\n        const subject: BehaviorSubject<Action> = new BehaviorSubject<Action>(new ScrollAction(this.rowHeightService.offset(skip)));\n\n        Observable.create(observer => {\n            this.unsubscribe();\n            this.scrollSubscription = this.scrollObservable.subscribe(x => this.onScroll(x, observer));\n\n        }).subscribe(x => subject.next(x));\n\n        return subject;\n    }\n\n    public destroy(): void {\n        this.unsubscribe();\n    }\n\n    protected onScroll({scrollTop, offsetHeight}: {scrollTop: number, offsetHeight: number}, observer: Observer<Action>): void {\n        if (this.lastScrollTop === scrollTop) {\n            return;\n        }\n\n        const up: boolean = this.lastScrollTop >= scrollTop;\n        this.lastScrollTop = scrollTop;\n\n        const firstItemIndex: number = this.rowHeightService.index(scrollTop);\n        const firstItemOffset: number = this.rowHeightService.offset(firstItemIndex);\n\n        const lastItemIndex: number = this.rowHeightService.index(scrollTop + offsetHeight);\n\n        if (!up && lastItemIndex >= this.lastLoaded && this.lastLoaded < this.total) {\n\n            this.firstLoaded = firstItemIndex;\n            observer.next(new ScrollAction(firstItemOffset));\n\n            let nextTake: number = this.firstLoaded + this.take;\n            this.lastLoaded = Math.min(nextTake, this.total);\n            nextTake = nextTake > this.total ? this.total - this.firstLoaded : this.take;\n            observer.next(new PageAction(this.firstLoaded, nextTake));\n        }\n\n        if (up && firstItemIndex <= this.firstLoaded) {\n\n            this.firstLoaded = Math.max(firstItemIndex - 1, 0);\n            observer.next(new ScrollAction(this.rowHeightService.offset(this.firstLoaded)));\n\n            this.lastLoaded = Math.min(this.firstLoaded + this.take, this.total);\n            observer.next(new PageAction(this.firstLoaded, this.take));\n        }\n    }\n\n    private unsubscribe(): void {\n        if (this.scrollSubscription) {\n            this.scrollSubscription.unsubscribe();\n            this.scrollSubscription = undefined;\n        }\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/scroller.service.ts\n **/","module.exports = require(\"rxjs/BehaviorSubject\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"rxjs/BehaviorSubject\"\n ** module id = 72\n ** module chunks = 26\n **/"],"sourceRoot":""}